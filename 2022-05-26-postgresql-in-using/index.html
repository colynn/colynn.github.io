<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta name=author content="Colynn.Liu"><meta name=description content="Full-Stack DevOps, Be focused and Practical"><link rel=prev href=https://colynn.github.io/2022-05-02-docker-volume/><link rel=canonical href=https://colynn.github.io/2022-05-26-postgresql-in-using/><link rel=apple-touch-icon sizes=180x180 href=/img/home-icon.png><link rel=icon type=image/png sizes=32x32 href=/img/favicon.png><link rel=icon type=image/png sizes=16x16 href=/img/favicon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#ffffff"><title>how to use PostgreSQL | Colynn.Liu</title><meta name=title content="how to use PostgreSQL | Colynn.Liu"><link rel=stylesheet href=/font/iconfont.css><link rel=stylesheet href=/css/main.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/colynn.github.io\/"},"articleSection":"posts","name":"how to use PostgreSQL","headline":"how to use PostgreSQL","description":"概述 架构 常用命令 连接 # connection export PGPASSWORD=examplepassword ; psql -h 127.0.0.1 -p 5432 -U admin -d database-name 创建数据库 ## create database, use binary file `createdb` createdb example001 # create database example001; show databases Use \\l or \\l\u002b in psql to show all databases in the current PostgreSQL server. Use the SELECT statement to query data from the pg_database to","inLanguage":"zh-CN","author":"Colynn.Liu","creator":"Colynn.Liu","publisher":"Colynn.Liu","accountablePerson":"Colynn.Liu","copyrightHolder":"Colynn.Liu","copyrightYear":"2022","datePublished":"2022-05-26 00:00:00 \u002b0000 UTC","dateModified":"2022-05-26 00:00:00 \u002b0000 UTC","url":"https:\/\/colynn.github.io\/2022-05-26-postgresql-in-using\/","wordCount":"417","keywords":["postgresql","Colynn.Liu"]}</script></head><body><div class=wrapper><nav class=navbar><div class=container><div class="navbar-header header-logo"><a href=https://colynn.github.io/>Colynn.Liu</a></div><div class="menu navbar-right"><a class=menu-item href=/posts/>文章</a>
<a class=menu-item href=/categories/>分类</a>
<a class=menu-item href=/tags/>标签</a>
<a class=menu-item href=/readings/>书单</a>
<a class=menu-item href=/aboutme/>关于我</a></div></div></nav><nav class=navbar-mobile id=nav-mobile style=display:none><div class=container><div class=navbar-header><div><a href=https://colynn.github.io/>Colynn.Liu</a></div><div class=menu-toggle><span></span><span></span><span></span></div></div><div class=menu id=mobile-menu><a class=menu-item href=/posts/>文章</a>
<a class=menu-item href=/categories/>分类</a>
<a class=menu-item href=/tags/>标签</a>
<a class=menu-item href=/readings/>书单</a>
<a class=menu-item href=/aboutme/>关于我</a></div></div></nav><main class=main><div class=container><article class=post-warp itemscope itemtype=http://schema.org/Article><header class=post-header><h1 class=post-title itemprop="name headline">how to use PostgreSQL</h1><div class=post-meta>Written by <a itemprop=name href=https://colynn.github.io/ rel=author>Colynn.Liu</a> with ♥
<span class=post-time>on <time datetime=2022-05-26 itemprop=datePublished>May 26, 2022</time></span>
<span class=post-time>- last modified on <time datetime=2022-05-26 itemprop=datePublished>May 26, 2022</time></span></div><div class=post-tags><section><span class=tag><a href=https://colynn.github.io/tags/postgresql/><i class="iconfont icon-tag"></i>postgresql</a></span></section><section></section></div></header><div class=post-content><h2 id=概述>概述</h2><h2 id=架构>架构</h2><h2 id=常用命令>常用命令</h2><h3 id=连接>连接</h3><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=color:#888># connection</span>
<span style=color:#007020>export</span> <span style=color:#963>PGPASSWORD</span><span style=color:#333>=</span>examplepassword ;  psql -h 127.0.0.1 -p <span style=color:#60e;font-weight:700>5432</span> -U admin -d database-name
</code></pre></div><h3 id=创建数据库>创建数据库</h3><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=color:#888>## create database, use binary file `createdb`</span>
createdb example001
</code></pre></div><pre><code># create database example001;
</code></pre><h3 id=show-databases>show databases</h3><ul><li>Use <code>\l</code> or <code>\l+</code> in psql to show all databases in the current PostgreSQL server.</li><li>Use the <code>SELECT</code> statement to query data from the <code>pg_database</code> to get all databases.</li></ul><p>use <code>\l</code> 或是 <code>\l+</code> 获取到更多的信息；</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql>postgres<span style=color:#333>-#</span> <span style=color:red;background-color:#faa>\</span>l
                                  List <span style=color:#080;font-weight:700>of</span> databases
    Name    <span style=color:#333>|</span>  <span style=color:#080;font-weight:700>Owner</span>   <span style=color:#333>|</span> <span style=color:#080;font-weight:700>Encoding</span> <span style=color:#333>|</span>   <span style=color:#080;font-weight:700>Collate</span>   <span style=color:#333>|</span>    Ctype    <span style=color:#333>|</span>   <span style=color:#080;font-weight:700>Access</span> <span style=color:#080;font-weight:700>privileges</span>   
<span style=color:#888>------------+----------+----------+-------------+-------------+-----------------------
</span><span style=color:#888></span> example001 <span style=color:#333>|</span> postgres <span style=color:#333>|</span> UTF8     <span style=color:#333>|</span> en_US.utf<span style=color:#333>-</span><span style=color:#00d;font-weight:700>8</span> <span style=color:#333>|</span> en_US.utf<span style=color:#333>-</span><span style=color:#00d;font-weight:700>8</span> <span style=color:#333>|</span> 
 pgdb       <span style=color:#333>|</span> postgres <span style=color:#333>|</span> UTF8     <span style=color:#333>|</span> en_US.utf<span style=color:#333>-</span><span style=color:#00d;font-weight:700>8</span> <span style=color:#333>|</span> en_US.utf<span style=color:#333>-</span><span style=color:#00d;font-weight:700>8</span> <span style=color:#333>|</span> <span style=color:#333>=</span>Tc<span style=color:#333>/</span>postgres         <span style=color:#333>+</span>
            <span style=color:#333>|</span>          <span style=color:#333>|</span>          <span style=color:#333>|</span>             <span style=color:#333>|</span>             <span style=color:#333>|</span> postgres<span style=color:#333>=</span>CTc<span style=color:#333>/</span>postgres<span style=color:#333>+</span>
            <span style=color:#333>|</span>          <span style=color:#333>|</span>          <span style=color:#333>|</span>             <span style=color:#333>|</span>             <span style=color:#333>|</span> pguser<span style=color:#333>=</span>CTc<span style=color:#333>/</span>postgres
 postgres   <span style=color:#333>|</span> postgres <span style=color:#333>|</span> UTF8     <span style=color:#333>|</span> en_US.utf<span style=color:#333>-</span><span style=color:#00d;font-weight:700>8</span> <span style=color:#333>|</span> en_US.utf<span style=color:#333>-</span><span style=color:#00d;font-weight:700>8</span> <span style=color:#333>|</span> 
(<span style=color:#00d;font-weight:700>3</span> <span style=color:#080;font-weight:700>rows</span>)

postgres<span style=color:#333>-#</span> 
</code></pre></div><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=color:#888>## show database</span>
SELECT datname FROM pg_database;
</code></pre></div><h3 id=delete-database>delete database</h3><pre><code>drop database databae-name;
</code></pre><h3 id=switch-database>switch database</h3><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=color:#888>## 切换数据库</span>
<span style=color:#963>pgdb</span><span style=color:#333>=</span><span style=color:#888># \c pgdb</span>
You are now connected to database <span style=background-color:#fff0f0>&#34;pgdb&#34;</span> as user <span style=background-color:#fff0f0>&#34;postgres&#34;</span>.
</code></pre></div><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#333>#</span> switch <span style=color:#080;font-weight:700>database</span> <span style=color:#080;font-weight:700>in</span> <span style=color:#080;font-weight:700>sql</span> scripts
<span style=color:red;background-color:#faa>\</span><span style=color:#080;font-weight:700>c</span> first_db_name
<span style=color:#080;font-weight:700>select</span> <span style=color:#333>*</span> <span style=color:#080;font-weight:700>from</span> t; <span style=color:#888>--- your sql
</span><span style=color:#888></span><span style=color:red;background-color:#faa>\</span><span style=color:#080;font-weight:700>c</span> second_db_name
<span style=color:#080;font-weight:700>select</span> <span style=color:#333>*</span> <span style=color:#080;font-weight:700>from</span> t; <span style=color:#888>--- your sql
</span><span style=color:#888></span>...
</code></pre></div><h3 id=tables>tables</h3><ul><li>Use the <code>\dt</code> or <code>\dt+</code> command in psql to show tables in a specific database.</li><li>Use the <code>SELECT</code> statement to query table information from the <code>pg_catalog.pg_tables</code> catalog.</li></ul><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql>postgres<span style=color:#333>=#</span> <span style=color:red;background-color:#faa>\</span>dt
          List <span style=color:#080;font-weight:700>of</span> relations
 <span style=color:#080;font-weight:700>Schema</span> <span style=color:#333>|</span>  Name   <span style=color:#333>|</span> <span style=color:#080;font-weight:700>Type</span>  <span style=color:#333>|</span>  <span style=color:#080;font-weight:700>Owner</span>   
<span style=color:#888>--------+---------+-------+----------
</span><span style=color:#888></span> <span style=color:#080;font-weight:700>public</span> <span style=color:#333>|</span> weather <span style=color:#333>|</span> <span style=color:#080;font-weight:700>table</span> <span style=color:#333>|</span> postgres
(<span style=color:#00d;font-weight:700>1</span> <span style=color:#080;font-weight:700>row</span>)

postgres<span style=color:#333>=#</span> <span style=color:red;background-color:#faa>\</span>dt<span style=color:#333>+</span>
                                     List <span style=color:#080;font-weight:700>of</span> relations
 <span style=color:#080;font-weight:700>Schema</span> <span style=color:#333>|</span>  Name   <span style=color:#333>|</span> <span style=color:#080;font-weight:700>Type</span>  <span style=color:#333>|</span>  <span style=color:#080;font-weight:700>Owner</span>   <span style=color:#333>|</span> Persistence <span style=color:#333>|</span> <span style=color:#080;font-weight:700>Access</span> <span style=color:#080;font-weight:700>method</span> <span style=color:#333>|</span>  <span style=color:#080;font-weight:700>Size</span>   <span style=color:#333>|</span> Description 
<span style=color:#888>--------+---------+-------+----------+-------------+---------------+---------+-------------
</span><span style=color:#888></span> <span style=color:#080;font-weight:700>public</span> <span style=color:#333>|</span> weather <span style=color:#333>|</span> <span style=color:#080;font-weight:700>table</span> <span style=color:#333>|</span> postgres <span style=color:#333>|</span> permanent   <span style=color:#333>|</span> heap          <span style=color:#333>|</span> <span style=color:#00d;font-weight:700>0</span> bytes <span style=color:#333>|</span> 
(<span style=color:#00d;font-weight:700>1</span> <span style=color:#080;font-weight:700>row</span>)
</code></pre></div><h3 id=privileges>privileges</h3><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#333>#</span> <span style=color:red;background-color:#faa>查看用户的表权限</span>
<span style=color:#080;font-weight:700>select</span> <span style=color:#333>*</span> <span style=color:#080;font-weight:700>from</span> information_schema.table_privileges 

<span style=color:#333>#</span> <span style=color:red;background-color:#faa>查看</span>usage权限表
<span style=color:#080;font-weight:700>select</span> <span style=color:#333>*</span> <span style=color:#080;font-weight:700>from</span> information_schema.usage_privileges <span style=color:#080;font-weight:700>where</span> grantee<span style=color:#333>=</span><span style=background-color:#fff0f0>&#39;user_name&#39;</span>;

<span style=color:#333>#</span><span style=color:red;background-color:#faa>查看存储过程函数相关权限表</span>
<span style=color:#080;font-weight:700>select</span> <span style=color:#333>*</span> <span style=color:#080;font-weight:700>from</span> information_schema.routine_privileges <span style=color:#080;font-weight:700>where</span> grantee<span style=color:#333>=</span><span style=background-color:#fff0f0>&#39;user_name&#39;</span>;

<span style=color:#333>#</span> <span style=color:red;background-color:#faa>建用户授权</span>
<span style=color:#080;font-weight:700>create</span> <span style=color:#080;font-weight:700>user</span> user_name;
<span style=color:#080;font-weight:700>alter</span> <span style=color:#080;font-weight:700>user</span> user_namewith password <span style=background-color:#fff0f0>&#39;&#39;</span>;
<span style=color:#080;font-weight:700>alter</span> <span style=color:#080;font-weight:700>user</span> user_namewith <span style=color:#080;font-weight:700>CONNECTION</span> <span style=color:#080;font-weight:700>LIMIT</span>  <span style=color:#00d;font-weight:700>20</span>;<span style=color:#333>#</span><span style=color:red;background-color:#faa>连接数限制</span>


<span style=color:#333>#</span> 
<span style=color:#080;font-weight:700>select</span> <span style=color:#333>*</span> <span style=color:#080;font-weight:700>from</span> INFORMATION_SCHEMA.role_table_grants
<span style=color:#333>#</span> <span style=color:#080;font-weight:700>or</span>
<span style=color:#080;font-weight:700>select</span> <span style=color:#333>*</span> <span style=color:#080;font-weight:700>from</span> information_schema.table_privileges
</code></pre></div><h2 id=参考>参考</h2><ul><li><a href=https://www.postgresql.org/docs/current/sql-commands.html>postgresql sql commands</a></li></ul><h2 id=operator>operator</h2><p>POSTGRES_USER=$(kubectl -n component get secrets pg-db-component-pguser-secret -o jsonpath=&rdquo;{.data.username}&rdquo; | base64 &ndash;decode)</p><p>POSTGRES_PASSWORD=$(kubectl -n component get secrets pg-db-component-pguser-secret -o jsonpath=&rdquo;{.data.password}&rdquo; | base64 &ndash;decode)</p></div><div class=post-copyright><p class=copyright-item><span>Author:</span>
<span>Colynn.Liu</span></p><p class=copyright-item><span>Link:</span>
<a href=https://colynn.github.io/2022-05-26-postgresql-in-using/>https://colynn.github.io/2022-05-26-postgresql-in-using/</span></p><p class="copyright-item lincese">本文采用<a rel=license href=http://creativecommons.org/licenses/by-nc/4.0/ target=_blank>知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可</p></div><div class=post-tags><section><i class="iconfont icon-tag"></i>Tag(s):
<span class=tag><a href=https://colynn.github.io/tags/postgresql/>#postgresql</a></span></section><section><a href=javascript:window.history.back();>back</a></span> ·
<span><a href=https://colynn.github.io/>home</a></span></section></div><div class=post-nav><a href=https://colynn.github.io/2022-05-02-docker-volume/ class=prev rel=prev title="理解并正确使用docker volume/bind mount"><i class="iconfont icon-left"></i>&nbsp;理解并正确使用docker volume/bind mount</a></div><div class=post-comment><div id=gitalk-container></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css><script src=https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js></script><script>const gitalk=new Gitalk({clientID:'7196948b9a586a342072',clientSecret:"1acf6a13bc1ce7b8d8e3554789781ba2aaa4575c",repo:"blog-comments",owner:"colynn",admin:"colynn",id:"/2022-05-26-postgresql-in-using/",distractionFreeMode:false,perPage:100});gitalk.render('gitalk-container')</script></div></article></div></main><footer class=footer><div class=copyright>&copy;
<span itemprop=copyrightYear>2018 - 2023</span>
<span class=with-love><i class="iconfont icon-love"></i></span><span class=author itemprop=copyrightHolder><a href=https://colynn.github.io/>Colynn.Liu</a> |</span>
<span><a href=https://colynn.github.io/friends>友情链接</a></span></div></footer><script src=/js/vendor_no_gallery.min.js async></script></div></body></html>