---
title: 持续的GitOps, 是时候启用了吗？
tags: ["gitops", "ci/cd"]
categories: []
date: 2020-09-21
lastmod: 2020-09-21
---


## 前言
对于 DevOps是不是大家均已经很熟悉，每论你的公司大与小也许你都已经存在了一个devops平台或是工具链，用来辅助环境配置、应用发布、监控等方面。

也许你可能遇到会这样的情形，jenkins或内部发布系统挂了，应用无法更新发布？怎么办？只能等着系统修复或是人肉来搞。。。

但是如果我们的代码、配置均存储至Git, 让 Git 成为我们唯一可以信赖的源，是不是可以缓存些上面的尴尬呢，比如发布系统挂了，但所有的配置均在 Git里，我们直接可以通过 `kubectl` (针对k8s集群内的应用)等命令将应用部署成功。

## What is GitOps
我们上说所提到的，代码及配置均保存至 Git, 而且通过 git push或是git pull来触发相应的 action.

GitOps一种针对云原生应用持续部署的方式, 它通过使用开发人员已经熟悉的工具(包括Git和持续部署工具),并且在运营基础设施时注重以开发人员为中心的体验。

GitOps的核心思想是拥有一个Git仓库，它总是包含生产环境中当前所需的基础架构的声明性描述，并有一个自动化流程使生产环境与仓库中的描述状态相匹配。如果你想部署一个新的应用程序或更新一个现有的应用程序，你只需要更新仓库,而其他的均由自动化流程处理。

## Why need GitOps

不想把GitOps的优点说的很魔幻，我感觉主要是两点
### 1. Deploy Faster More Often 更快、更频率地部署，
的确，因为你需求提交代码，不需求再打开 jenkins 或是其他的构建/部署系统，但是如果你的部署流程中包含审批之类的流程，并不能真正地改善（因为虽然你可以快速触发，但是你还需要等待审批）。

### 2. Easy and Fast Error Recovery 更容易、更快的回滚
因为代码、配置均在仓库中，你可以很轻松地使用`git revert`来回滚操作。

### 3. 其他优点（觉得并不能作为优点）
* Easier Credential Management,
* Self-documenting Deployments
* Shared Knowledge in Teams
__注__: 上面的这三个点对于你们目前没有一个较好的构建/发布流程的话，会是一个优点，但是如果你们已经有一个较好的构建部署平台，那么这几点则就显得没有什么意义。

## How does GitOps work

### 环境部署作为Git仓库

### Push-based Deployments

### Pull-based Deployments

### Woarking with Multiple Applications and Environments


## 最佳实践

## 思考
1. 
