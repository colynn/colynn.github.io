<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta name=author content="Colynn.Liu"><link rel=prev href=https://colynn.github.io/2019-02-13-charles_capture_package/><link rel=next href=https://colynn.github.io/2019-12-31-go_basic_knowledge_summarizing/><link rel=canonical href=https://colynn.github.io/2019-03-05-mac_prepare_php_env/><link rel=apple-touch-icon sizes=180x180 href=/img/favicon.png><link rel=icon type=image/png sizes=32x32 href=/img/favicon.png><link rel=icon type=image/png sizes=16x16 href=/img/favicon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#ffffff"><title>Mac-PHP环境准备 | Colynn.Liu</title><meta name=title content="Mac-PHP环境准备 | Colynn.Liu"><link rel=stylesheet href=/font/iconfont.css><link rel=stylesheet href=/css/main.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/colynn.github.io\/"},"articleSection":"posts","name":"Mac-PHP环境准备","headline":"Mac-PHP环境准备","description":"前置条件 Mac OS 10.13.6 安装Homebrew 包管理工具； 安装 autoconf (解决xdebug编译依赖问题) 说明: brew 全称Homebrew, 是Mac OSX上的软件包管","inLanguage":"zh-CN","author":"Colynn.Liu","creator":"Colynn.Liu","publisher":"Colynn.Liu","accountablePerson":"Colynn.Liu","copyrightHolder":"Colynn.Liu","copyrightYear":"2019","datePublished":"2019-03-15 00:00:00 \u002b0000 UTC","dateModified":"2019-03-15 00:00:00 \u002b0000 UTC","url":"https:\/\/colynn.github.io\/2019-03-05-mac_prepare_php_env\/","wordCount":"963","keywords":["php","Colynn.Liu"]}</script></head><body><div class=wrapper><nav class=navbar><div class=container><div class="navbar-header header-logo"><a href=https://colynn.github.io/>Colynn.Liu</a></div><div class="menu navbar-right"><a class=menu-item href=/posts/>文章</a>
<a class=menu-item href=/categories/>分类</a>
<a class=menu-item href=/tags/>标签</a>
<a class=menu-item href=/aboutme/>关于我</a></div></div></nav><nav class=navbar-mobile id=nav-mobile style=display:none><div class=container><div class=navbar-header><div><a href=https://colynn.github.io/>Colynn.Liu</a></div><div class=menu-toggle><span></span><span></span><span></span></div></div><div class=menu id=mobile-menu><a class=menu-item href=/posts/>文章</a>
<a class=menu-item href=/categories/>分类</a>
<a class=menu-item href=/tags/>标签</a>
<a class=menu-item href=/aboutme/>关于我</a></div></div></nav><main class=main><div class=container><article class=post-warp itemscope itemtype=http://schema.org/Article><header class=post-header><h1 class=post-title itemprop="name headline">Mac-PHP环境准备</h1><div class=post-meta>Written by <a itemprop=name href=https://colynn.github.io/ rel=author>Colynn.Liu</a> with ♥
<span class=post-time>on <time datetime=2019-03-15 itemprop=datePublished>March 15, 2019</time></span>
<span class=post-time>- last modified <time datetime=2019-03-15 itemprop=datePublished>March 15, 2019</time></span></div><div class=post-tags><section><span class=tag><a href=https://colynn.github.io/tags/php/><i class="iconfont icon-tag"></i>php</a></span></section><section><i class="iconfont icon-folder"></i><span class=post-category><a href=https://colynn.github.io/categories/%E6%95%99%E7%A8%8B/>教程</a></span></section></div></header><div class=post-content><h3 id=前置条件>前置条件</h3><ol><li>Mac OS 10.13.6</li><li>安装Homebrew 包管理工具；</li><li>安装 autoconf (解决xdebug编译依赖问题)</li></ol><p><strong>说明</strong>: brew 全称Homebrew, 是Mac OSX上的软件包管理工具</p><p><em>注</em>: PECL（The PHP Extension Community Library）是 PHP 扩展的存储库，为 PHP所有的扩展提供提供托管和下载服务。
通过 PEAR的 Package Manager 的安装管理方式，可以对PECL扩展进行下载和安装</p><h3 id=安装清单>安装清单</h3><ol><li>php71</li><li>xdebug (调试)</li><li>nginx</li><li>mysql</li></ol><p><strong>说明</strong>: Mac OS默认安装了php, apache， 但是不推荐使用此默认设置，原因有二（服务配置涉及权限配置调整，没有提供方便的服务启停方式；）</p><h4 id=前置条件---homebrew安装>前置条件 - Homebrew安装</h4><ol><li>安装编译依赖</li></ol><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>xcode-select --install
</code></pre></div><ol start=2><li>安装Homebrew：</li></ol><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>ruby -e <span style=background-color:#fff0f0>&#34;</span><span style=color:#080;font-weight:700>$(</span>curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install<span style=color:#080;font-weight:700>)</span><span style=background-color:#fff0f0>&#34;</span>
</code></pre></div><h4 id=前置条件---autoconf>前置条件 - autoconf</h4><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ brew install autoconf
</code></pre></div><h4 id=1php71>1.php71</h4><ol><li>安装</li></ol><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ brew install php71 --without-apache  --with-fpm
</code></pre></div><ol start=2><li>可执行文件添加至环境变量</li></ol><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=color:#007020>echo</span> <span style=background-color:#fff0f0>&#39;export PATH=&#34;/usr/local/opt/php@7.1/bin:$PATH&#34;&#39;</span> &gt;&gt; ~/.bash_profile
<span style=color:#007020>echo</span> <span style=background-color:#fff0f0>&#39;export PATH=&#34;/usr/local/opt/php@7.1/sbin:$PATH&#34;&#39;</span> &gt;&gt; ~/.bash_profile
</code></pre></div><h4 id=2-xdebug>2. xdebug</h4><ol><li><p>安装</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ pecl install xdebug

....
Installing <span style=background-color:#fff0f0>&#39;/usr/local/Cellar/php@7.1/7.1.24_2/pecl/20160303/xdebug.so&#39;</span>
install ok: channel://pecl.php.net/xdebug-2.6.1
Extension xdebug enabled in php.ini
</code></pre></div></li><li><p>配置</p><ul><li>将xdebug.so 文件拷贝或是软链接至 /usr/local/opt/php@7.1/lib/php/20160303</li></ul></li></ol><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ cp /usr/local/Cellar/php@7.1/7.1.24_2/pecl/20160303/xdebug.so /usr/local/opt/php@7.1/lib/php/20160303/
</code></pre></div><p><img src=https://user-images.githubusercontent.com/5203608/89494621-1cdfc400-d7e9-11ea-955f-370005669de2.png alt=image></p><p><em>原因</em>: 因为默认安装后，php.ini配置文件会以相对路径引用，所以需要拷贝至lib库目录；也可使用绝对路径引用，就无此操作。</p><ul><li>xdebug示例配置，添加至php.ini</li></ul><pre><code class=language-conf data-lang=conf>[xdebug]
xdebug.remote_enable = 1
xdebug.remote_port = 9000
;自动跟踪，可关闭（关闭后提升性能）
xdebug.auto_trace=On
;性能分析，可关闭（关闭后提升性能）
xdebug.profiler_enable=On
</code></pre><ol start=3><li>重启php服务</li></ol><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>brew services restart php@7.1
</code></pre></div><h4 id=3-nginx>3. nginx</h4><ol><li>安装</li></ol><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ brew install nginx
</code></pre></div><ol start=2><li><p>配置</p><ul><li>备份默认配置</li></ul></li></ol><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ cp /usr/local/etc/nginx/nginx.conf /usr/local/etc/nginx/nginx.conf.default
</code></pre></div><pre><code>* 修改配置,主要修改项示例如下：

```conf
server {
        listen       8080;
        server_name  localhost;

        #charset koi8-r;

        access_log  logs/host.access.log  main;

        root        [php-code-directory];

        index index.php;

        location / {
            index  index.html index.htm index.php;
        }

        #error_page  404              /404.html;

        # redirect server error pages to the static page /50x.html
        #
        error_page   500 502 503 504  /50x.html;
        location = /50x.html {
            root   html;
        }

        # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000
        #
        location ~ \.php$ {
            # root           html;
            fastcgi_pass   127.0.0.1:9000;
            fastcgi_index  index.php;
            # fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;
            fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;
            include        fastcgi_params;
        }

        # deny access to .htaccess files, if Apache's document root
        # concurs with nginx's one
        #
        location ~ /\.ht {
            deny  all;
        }
    }
```
</code></pre><h4 id=4-mysql根据需要>4. mysql（根据需要）</h4><ol><li>安装</li></ol><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>brew install mysql mysql-client
</code></pre></div><ol start=2><li><p>配置 mysql-client 添加至环境变量</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>If you need to have mysql-client first in your PATH run:
  <span style=color:#007020>echo</span> <span style=background-color:#fff0f0>&#39;export PATH=&#34;/usr/local/opt/mysql-client/bin:$PATH&#34;&#39;</span> &gt;&gt; ~/.bash_profile

For compilers to find mysql-client you may need to set:
  <span style=color:#007020>export</span> <span style=color:#963>LDFLAGS</span><span style=color:#333>=</span><span style=background-color:#fff0f0>&#34;-L/usr/local/opt/mysql-client/lib&#34;</span>
  <span style=color:#007020>export</span> <span style=color:#963>CPPFLAGS</span><span style=color:#333>=</span><span style=background-color:#fff0f0>&#34;-I/usr/local/opt/mysql-client/include&#34;</span>
</code></pre></div></li></ol><h4 id=5服务管理>5.服务管理</h4><ol><li>重启php@71</li></ol><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ brew services restart php@7.1
</code></pre></div><ol start=2><li>重启nginx</li></ol><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ brew services restart nginx
</code></pre></div><ol start=3><li>nginx也可通过如下命令reload</li></ol><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ nginx -t
$ nginx -s reload
</code></pre></div><ol start=4><li>重启mysql 服务</li></ol><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>brew services restart mysql
</code></pre></div><h4 id=常见问题>常见问题</h4><ol><li>安装xdebug过程中遇到权限问题，请开启如下设置
按住command+R，打开命令行，输入：<code>csrutil disable</code> 然后，重启Mac系统</li></ol><p>否则，没有权限操作/usr/文件夹下的内容；</p><p>配置好xdebug后，再修改回来，<code>csrutil enable</code></p><p>0.2 安装xdebug时的，error，xdebug.c:25:10: fatal error: &lsquo;php.h&rsquo; file not found</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ xcode-select --install
</code></pre></div><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>sudo ln -s /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk/usr/include /usr/include
</code></pre></div><p><em>注</em>: 将MacOSX10.14替换成你自己的系统版本号</p></div><div class=post-copyright><p class=copyright-item><span>Author:</span>
<span>Colynn.Liu</span></p><p class=copyright-item><span>Link:</span>
<a href=https://colynn.github.io/2019-03-05-mac_prepare_php_env/>https://colynn.github.io/2019-03-05-mac_prepare_php_env/</span></p><p class="copyright-item lincese">本文采用<a rel=license href=http://creativecommons.org/licenses/by-nc/4.0/ target=_blank>知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可</p></div><div class=post-tags><section><i class="iconfont icon-tag"></i>Tag(s):
<span class=tag><a href=https://colynn.github.io/tags/php/>#php</a></span></section><section><a href=javascript:window.history.back();>back</a></span> ·
<span><a href=https://colynn.github.io/>home</a></span></section></div><div class=post-nav><a href=https://colynn.github.io/2019-02-13-charles_capture_package/ class=prev rel=prev title="Charles 抓包（http/https）"><i class="iconfont icon-left"></i>&nbsp;Charles 抓包（http/https）</a>
<a href=https://colynn.github.io/2019-12-31-go_basic_knowledge_summarizing/ class=next rel=next title=Go语法汇总>Go语法汇总&nbsp;<i class="iconfont icon-right"></i></a></div><div class=post-comment><script src=https://utteranc.es/client.js repo=colynn/blog-comments issue-term=pathname label=utterances theme=github-light crossorigin=anonymous async></script></div></article></div></main><footer class=footer><div class=copyright>&copy;
<span itemprop=copyrightYear>2018 - 2020</span>
<span class=with-love><i class="iconfont icon-love"></i></span><span class=author itemprop=copyrightHolder><a href=https://colynn.github.io/>Colynn.Liu</a> |</span>
<span><a href=https://colynn.github.io/friends>友情链接</a></span></div></footer><link href=//lib.baomitu.com/lightgallery/1.6.11/css/lightgallery.min.css rel=stylesheet><script src=/js/vendor_gallery.min.js async></script></div></body></html>